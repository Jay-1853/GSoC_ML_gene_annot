# GSoC_ML_gene_annot

GSoC HAVANA project "Using machine learning to annotate difficult genes"


## Brief Explanation

Understanding the impact of genetic variation on disease requires comprehensive gene annotation. Human genes are well characterised following more than two decades of work on their annotation, however, we know that this annotation is not complete and that new experimental methods are generating data to help us towards the goal of complete gene annotation. 

We have developed an automated workflow to use long transcriptomic data to add novel alternatively spliced transcripts to our gene annotation. Our method uses very strict thresholds to ensure that no poor-quality models are added to the gene annotation, although as a consequence we reject significant numbers of viable novel transcripts. We want to use machine learning to recover good quality but rejected transcripts and improve the setting of initial filters for new datasets.

### Expected results

- Install and learn to use a machine learning package
- Run it on known gene annotation
- Deliverable: simple model that helps to recover valid transcripts; set of most relevant features for decision making

### Required knowledge

Machine learning

### Difficulty

Medium

### Mentors

Jonathan Mudge, Jose Manuel Gonzalez Martinez, Adam Frankish


## Detailed description of the project
We have developed an automated workflow to use long transcriptomic data to add novel alternatively spliced transcripts to our gene annotation.

- In principal the method is agnostic to the method used to generate the annotation as further filters are applied in addition to those in the primary annotation pipeline but in practice the better the primary annotation method, the better the results

- Our manual annotation is higher quality than that generated by any purely computational method so we need to set our standards very high and only allow high quality transcripts be added automatically to the annotation

  - In practice we would look for an error rate of <0.1%


Our method uses very strict thresholds to ensure that no poor-quality models are added to the gene annotation

- Filters were derived from manual QC of thousands of transcripts

- Filters include:

  - using a very limited definition of canonical splicing 
    - GT-AG only
    - Any other introns rejected

  - using the expression of any novel introns relative to the expression of annotated introns at the same locus

    - Using [Recount3](https://rna.recount.bio) RNAseq intron spanning reads 

  - using overlaps of splice sites with repeat elements

    - Transposable elements and tandem repeats

  - using overlap on the opposite strand with annotated transcripts
  - using an minimum intron length threshold of 50 nt

- All of these filters capture a large number of valid transcript models

  - Estimated false negative rate ~20%

  - So there are large numbers of valid transcripts being rejected


We want to use machine learning to recover good quality but rejected transcripts and improve the setting of initial filters for new datasets

- We have a large set of high confidence introns in the current annotation

- BUT this is subject to bias - particularly as they are expressed at a higher level

- Manual investigation suggests that Recount3 data will be important to help discriminate rejected introns but cannot be relied on absolutely


We would like the project to investigate other potential data that could be used to reduce the false negative rate for annotation filtering

- Eg features not investigated to date include genome sequence beyond the core splice site, splice site strength and evolutionary conservation of splice sites

- Any validated reduction would be considered successful

- Billions of reads will be processed over the next few years so any improvement in the recovery of transcripts could lead to the incorporation of thousands of transcripts into the annotation


Mentors will be able to offer guidance on the use of existing annotation, the biology of the processes we are trying to model in the data, finding published data to support the work of the project and the identification of training/test sets.


## Background of the project

The arrival of long read transcriptomics technologies has provided us with potentially hundreds of thousands of possible novel transcript variants that could be added to already well-annotated genomes such as human and mouse. However, manual gene annotation is very time-consuming, so we created an automated workflow to process these datasets while minimising the addition of low quality transcripts that would have been rejected by experienced annotators.
In order to evaluate the problems that we could face, we carried out a test with the manual annotation of almost 2,000 transcripts generated from alignments of long reads from various sources against the human genome sequence. Our gene annotators identified a set of features that could be useful to predict whether a transcript was not good enough to be integrated in the human gene annotation. 
Subsequently, we performed an exploratory analysis to determine the relevance of these features in the annotators' decisions.
Eventually, we decided to set stringent thresholds these features based on our observations and use them to filter out low quality long read transcripts.

Splice junctions are the most important determinants of transcript quality. An annotator will reject a transcript if one of its splice junctions is  incorrect. This explains why most of the chosen features were related to splice junctions.

Details of the annotation assessment results and the exploratory analysis can be found in [these slides](https://github.com/jmgonzmart/GSoC_ML_gene_annot/blob/main/analysis_update.pdf).

The data underlying the analysis can be found in [this file](https://github.com/jmgonzmart/GSoC_ML_gene_annot/blob/main/gene_annot_test.tsv). The most relevant columns are the following:
- coords: genomic coordinates of the intron
- outcome: annotator's decision on the quality of the splice junction or the transcript
- score: number of RNA-seq reads that support the splice junction from a resource similar to Recount3
- length: intron length
- prev_annot: whether this splice junction was already present in the human gene annotation
- splice_site: donor and acceptor site sequence
- repeat_overlap: whether the splice site (either donor site or acceptor site) overlaps a repeat feature of the human genome sequence
- ss_antisense: whether the splice site overlaps an exon on the opposite strand
- transcript_id: transcript identifier in our database
- bbiotype: gene biotype category
- rel_int_sup: relative intron support, log(intron score / average score of other introns in the same transcript)


## Input data

The datasets for this project will include:
- the current human gene annotation from [GENCODE](https://www.gencodegenes.org), which we assume that is entirely correct,
- a small set of long read transcripts that have been rejected by annotators and,
- ideally, an extended set of low-quality transcript or splice junction predictions that should be created by the student during the project.

The main input data format for this project is a standard gene annotation format such as GTF or GFF3.
The transcript and splice junction coordinates as well as their sequences will be extracted in order to obtain the relevant features by, for instance, comparing coordinates with existing annotation or repeat features. Help will be provided in this respect.

As mentioned above, the set of features and thresholds that we have used so far is by no means definitive. We encourage the student to investigate the use of additional features for both transcripts and splice junctions. 



